---

# 摄影小程序管理后台产品需求文档 (PRD)

| 文档版本 | 修改日期 | 修改人 | 修改内容 |
| :--- | :--- | :--- | :--- |
| V1.0 | 202X-XX-XX | [你的名字] | 初始版本创建 |

## 1. 项目背景与目标
### 1.1 项目背景
已开发一款面向C端用户的摄影展示与选片小程序。为了支撑小程序的运营，需要构建一个PC端管理后台。
### 1.2 项目目标
1.  **高效管理**：为摄影师/管理员提供作品发布、客片管理、订单处理的一站式工作台。
2.  **大屏选片**：为C端客户提供PC端Web访问入口，解决手机屏幕小、看不清细节的选片痛点。
3.  **权限控制**：通过RBAC（基于角色的访问控制）模型，确保管理员、员工、客户的数据安全与隔离。

---

## 2. 用户角色与权限 (RBAC设计)

这是本系统的核心难点，需要明确划分内部人员与外部客户的界限。

| 角色                               | 说明            | 核心权限                                                                         |
| :--------------------------------- | :-------------- | :------------------------------------------------------------------------------- |
| **超级管理员** (Admin)             | 老板/系统拥有者 | 拥有所有权限，包括系统设置、账号分配、财务查看。                                 |
| **摄影师/修图师** (`photographer`) | 内部员工        | 仅能查看和管理指派给自己的项目/客片；上传原片、上传精修片。                      |
| **销售/客服** (`sales`)            | 内部员工        | 客户档案管理、订单跟进、查看项目进度，无删除照片权限。                           |
| **客户** (`customer`)              | 外部用户 (C端)  | **受限视图**。登录后仅能进入“我的选片台”，查看自己的照片、进行选片、加购、下载。 |

---

## 3. 功能模块架构图 (Information Architecture)

```text
管理后台
├── 1. 工作台 (Dashboard)
│   ├── 数据概览 (访问量/订单量/待办事项)
│   └── 快捷入口
├── 2. 作品集管理 (用于小程序展示)
│   ├── 作品列表 (增删改查：上传作品集素材)
│   ├── 分类管理 (婚纱/写真/儿童等)
│   └── 轮播图配置
├── 3. 交付与选片管理 (核心业务)
│   ├── 项目创建 (关联客户)
│   ├── 照片库 (交付照片：原片上传/水印设置/分级)
│   ├── 选片链接生成/分享
│   └── 精修交付 (上传精修/客户确认)
├── 4. 客户与订单 (CRM)
│   ├── 客户档案
│   └── 订单列表 (状态流转)
├── 5. 客户PC选片端 (独立视图)
│   ├── 浏览照片 (大图/对比)
│   ├── 选片标记 (喜欢/入册/精修)
│   └── 提交选片
└── 6. 系统设置
    ├── 账号与权限
    ├── 存储配置
    └── 小程序配置
```

---

## 4. 详细功能需求说明

### 4.0 概念与范围澄清：作品集素材 vs 交付照片（必须区分）

为避免“上传图片”概念混淆，本系统把图片上传分为两类，分别属于不同模块、权限、存储策略与路由入口：

1. **作品集素材**（用于小程序展示/营销内容）
   - **归属模块**：4.2 作品集管理（CMS）
   - **典型内容**：作品图、作品封面、轮播图、视频封面等
   - **权限特征**：面向内部运营/管理员；不与客户选片项目绑定
   - **推荐路由入口（Admin）**：作品列表/编辑页中上传（例如：`/dashboard/portfolio/works`），轮播图在 `banners`

2. **交付照片**（用于客户选片/交付链路）
   - **归属模块**：4.3 交付与选片管理（照片库/精修交付）
   - **典型内容**：项目原片、预览图（带水印）、缩略图、精修交付图
   - **权限特征**：强数据隔离（项目/客户维度），原图私有；预览图可通过选片链接访问
   - **推荐路由入口（Admin）**：照片库（例如：`/dashboard/delivery/photos`），以及项目详情下的项目照片库（如后续增加）

> 实现建议（接口约定）：直传签名/STS 建议统一走一个 `POST /assets/sign`，并通过 `purpose` 区分“作品集素材/交付照片”；上传完成后的“确认入库/绑定业务”再按领域拆分（作品集素材确认、交付照片确认），避免把两类资产的权限与归档策略混用。

### 4.1 登录与鉴权模块

- **功能描述**：支持账号密码登录（员工）和 微信扫码/手机号验证码登录（客户）。
- **逻辑**：
  - 系统根据登录账号判断角色。
  - 若是**员工**，进入完整的管理后台界面。
  - 若是**客户**，自动跳转至“沉浸式选片工作台”，屏蔽所有管理菜单，只显示该客户关联的项目数据。

### 4.2 作品集管理 (CMS)

- **发布作品**：支持多图上传、视频上传、富文本描述、关联标签（Tag）。
- **展示设置**：控制小程序端的首页推荐、排序。
- **SEO配置**：虽然是小程序，但可预留标题关键词字段用于搜索优化。

### 4.3 交付与选片管理 (核心业务)

这是摄影师使用频率最高的功能。

#### 4.3.1 创建项目

- **字段**：项目名称、拍摄日期、关联客户（手机号/微信）、套餐类型（如：精修10张，底片全送）。
- **权限设置**：设置该项目是否允许下载原图、是否开启防盗链水印、选片截止日期。

#### 4.3.2 照片上传与处理

- **批量上传**：支持拖拽上传，支持断点续传（摄影原片很大，必须考虑稳定性）。
- **自动水印**：后台上传后，系统自动生成带水印的“预览图”供小程序和客户PC端查看，原图加密存储。
- **分组管理**：支持创建子相册（如：第一套服装、外景、内景）。

#### 4.3.3 选片进度监控

- **状态流转**：待选片 -> 客户选片中 -> 客户已提交 -> 修图师修图中 -> 待确认 -> 已交付。
- **通知**：当客户提交选片时，后台通知摄影师；当修图完成上传时，小程序通知客户。

### 4.4 客户PC选片端 (Client View)

这是专门给客户用的界面，设计需极简、高端。

- **瀑布流/大图模式**：支持按键盘方向键切换照片，空格键标记“喜欢”。
- **对比模式**：支持两张照片并排对比（纠结症客户刚需）。
- **选片逻辑**：
  - 实时显示：已选 X 张 / 套餐包涵 Y 张。
  - **加片引导**：如果选了 X > Y，提示需支付额外费用（支持生成加片订单二维码）。
- **提交确认**：客户点击“确认选片”后，锁定选择，不可再更改，后台状态更新。

### 4.5 订单与财务

- **订单同步**：同步小程序的支付订单。
- **线下录入**：支持管理员手动录入线下收款记录，修改订单状态。
- **二销管理**：记录选片阶段产生的额外加片费、相册制作费。

### 4.6 系统设置 (权限配置)

- **角色管理**：预设角色（管理员、摄影师、客户），支持自定义角色。
- **账号管理**：添加员工账号，分配角色。
- **水印设置**：上传品牌Logo，设置水印透明度、位置（九宫格或全屏铺满）。

---

## 5. 非功能性需求 (技术指标)

1.  **存储与带宽**：
    - 照片必须使用对象存储（如阿里云OSS/腾讯云COS）。
    - **CDN加速**：确保客户在小程序和PC端加载几百张照片时流畅无卡顿。
    - **缩略图服务**：上传一张原图（20MB），系统需自动生成 缩略图（列表用）、预览图（选片用，带水印）、原图（下载用）三种规格。
2.  **安全性**：
    - **防爬虫/防盗图**：预览图强制加水印，禁用右键保存（PC端）。
    - **数据隔离**：客户A绝对不能通过修改URL参数访问到客户B的照片。
3.  **并发性**：
    - 考虑到是展示类，并发要求不高，但上传带宽要求高。

---

## 6. 交互设计建议 (UI/UX)

- **管理端风格**：建议使用 Ant Design Pro 或 Element Plus 等成熟的B端组件库，深色模式（Dark Mode）往往更受摄影师喜欢，因为更能凸显照片色彩。
- **客户选片端风格**：全屏沉浸式，黑色背景，操作按钮最小化，突出照片本身。

---

## 7. 总结与开发优先级

**P0 (必须有)**：

1.  管理员/摄影师登录。
2.  项目创建与照片批量上传（带水印处理）。
3.  小程序作品集内容配置。
4.  客户PC端访问链接生成及基本的选片功能。

**P1 (应该有)**：

1.  多级权限管理（老板vs员工）。
2.  选片加购逻辑（超出张数自动计算金额）。
3.  订单状态流转与通知。

**P2 (可以有)**：

1.  数据大屏（统计本月拍摄量、选片率）。
2.  修图师绩效统计。

---

**建议**：在开发“客户使用后台”这一功能时，技术上建议**不要**让客户进入真正的 Admin 系统，而是开发一个独立的 `viewer` 页面（例如 `admin.site.com/client/selection/{uuid}`），这样既保证了安全性，又能完全自定义客户的选片体验。
42.1s
